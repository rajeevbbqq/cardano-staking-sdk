// Generated by purs version 0.14.5
"use strict";
var Address = require("../Address/index.js");
var Control_Alt = require("../Control.Alt/index.js");
var Control_Alternative = require("../Control.Alternative/index.js");
var Control_Applicative = require("../Control.Applicative/index.js");
var Control_Apply = require("../Control.Apply/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_Maybe = require("../Data.Maybe/index.js");
var Data_Newtype = require("../Data.Newtype/index.js");
var Data_Traversable = require("../Data.Traversable/index.js");
var Deserialization_FromBytes = require("../Deserialization.FromBytes/index.js");
var Deserialization_PlutusData = require("../Deserialization.PlutusData/index.js");
var Scripts = require("../Scripts/index.js");
var Serialization = require("../Serialization/index.js");
var Serialization_PlutusData = require("../Serialization.PlutusData/index.js");
var Types_ByteArray = require("../Types.ByteArray/index.js");
var Types_Datum = require("../Types.Datum/index.js");
var Types_OutputDatum = require("../Types.OutputDatum/index.js");
var Types_UnbalancedTransaction = require("../Types.UnbalancedTransaction/index.js");
var Untagged_Union = require("../Untagged.Union/index.js");
var txOutRefToTransactionInput = function (v) {
    return Control_Bind.bind(Data_Maybe.bindMaybe)(Data_Functor.mapFlipped(Data_Maybe.functorMaybe)(Types_ByteArray.hexToByteArray(v.txId))(Data_Newtype.wrap()))(function (transactionId) {
        return Control_Applicative.pure(Data_Maybe.applicativeMaybe)(Data_Newtype.wrap()({
            transactionId: transactionId,
            index: v.index
        }));
    });
};
var transactionInputToTxOutRef = function (v) {
    return {
        txId: Types_ByteArray.byteArrayToHex(Data_Newtype.unwrap()(v.transactionId)),
        index: v.index
    };
};
var toOutputDatum = function (d) {
    return function (dh) {
        return Data_Maybe.fromMaybe(Types_OutputDatum.NoOutputDatum.value)(Control_Alt.alt(Data_Maybe.altMaybe)(Data_Functor.map(Data_Maybe.functorMaybe)(Types_OutputDatum.OutputDatum.create)(d))(Data_Functor.map(Data_Maybe.functorMaybe)(Types_OutputDatum.OutputDatumHash.create)(dh)));
    };
};
var scriptDatumToOutputDatum = function (v) {
    if (v instanceof Types_UnbalancedTransaction.ScriptDatum) {
        return new Types_OutputDatum.OutputDatum(v.value0);
    };
    if (v instanceof Types_UnbalancedTransaction.ScriptDatumHash) {
        return new Types_OutputDatum.OutputDatumHash(v.value0);
    };
    throw new Error("Failed pattern match at TxOutput (line 214, column 1 - line 214, column 59): " + [ v.constructor.name ]);
};
var scriptOutputToTransactionOutput = function (networkId) {
    return function (v) {
        return {
            address: Scripts.validatorHashEnterpriseAddress(networkId)(v.validatorHash),
            amount: v.value,
            datum: scriptDatumToOutputDatum(v.datum),
            scriptRef: Data_Maybe.Nothing.value
        };
    };
};
var outputDatumToScriptDatum = function (v) {
    if (v instanceof Types_OutputDatum.OutputDatum) {
        return new Data_Maybe.Just(new Types_UnbalancedTransaction.ScriptDatum(v.value0));
    };
    if (v instanceof Types_OutputDatum.OutputDatumHash) {
        return new Data_Maybe.Just(new Types_UnbalancedTransaction.ScriptDatumHash(v.value0));
    };
    if (v instanceof Types_OutputDatum.NoOutputDatum) {
        return Data_Maybe.Nothing.value;
    };
    throw new Error("Failed pattern match at TxOutput (line 209, column 1 - line 209, column 65): " + [ v.constructor.name ]);
};
var transactionOutputToScriptOutput = function (v) {
    return Control_Bind.bind(Data_Maybe.bindMaybe)(outputDatumToScriptDatum(v.datum))(function (scriptDatum) {
        return Control_Bind.bind(Data_Maybe.bindMaybe)(Address.enterpriseAddressValidatorHash(v.address))(function (validatorHash) {
            return Control_Applicative.pure(Data_Maybe.applicativeMaybe)({
                validatorHash: validatorHash,
                value: v.amount,
                datum: scriptDatum
            });
        });
    });
};
var ogmiosDatumToDatum = Control_Bind.composeKleisli(Data_Maybe.bindMaybe)(Types_ByteArray.hexToByteArray)(Control_Bind.composeKleisli(Data_Maybe.bindMaybe)(Deserialization_FromBytes.fromBytes(Deserialization_FromBytes.fromBytesPlutusData))((function () {
    var $57 = Data_Functor.map(Data_Maybe.functorMaybe)(Types_Datum.Datum);
    return function ($58) {
        return $57(Deserialization_PlutusData.convertPlutusData($58));
    };
})()));
var ogmiosDatumHashToDatumHash = function (str) {
    return Data_Functor.mapFlipped(Data_Maybe.functorMaybe)(Types_ByteArray.hexToByteArray(str))(Data_Newtype.wrap());
};
var ogmiosDatumToScriptDatum = function (d) {
    return function (dh) {
        var datumHash = Data_Functor.mapFlipped(Data_Maybe.functorMaybe)(Control_Bind.bind(Data_Maybe.bindMaybe)(dh)(ogmiosDatumHashToDatumHash))(Types_UnbalancedTransaction.ScriptDatumHash.create);
        var datum = Data_Functor.mapFlipped(Data_Maybe.functorMaybe)(Control_Bind.bind(Data_Maybe.bindMaybe)(d)(ogmiosDatumToDatum))(Types_UnbalancedTransaction.ScriptDatum.create);
        return Control_Alt.alt(Data_Maybe.altMaybe)(datum)(datumHash);
    };
};
var ogmiosTxOutToScriptOutput = function (v) {
    return Control_Bind.bind(Data_Maybe.bindMaybe)(ogmiosDatumToScriptDatum(v.datum)(v.datumHash))(function (scriptDatum) {
        return Control_Bind.bind(Data_Maybe.bindMaybe)(Address.ogmiosAddressToAddress(v.address))(function (address$prime) {
            return Control_Bind.bind(Data_Maybe.bindMaybe)(Address.enterpriseAddressValidatorHash(address$prime))(function (validatorHash) {
                return Control_Applicative.pure(Data_Maybe.applicativeMaybe)({
                    validatorHash: validatorHash,
                    value: v.value,
                    datum: scriptDatum
                });
            });
        });
    });
};
var ogmiosTxOutToTransactionOutput = function (v) {
    return Control_Bind.bind(Data_Maybe.bindMaybe)(Address.ogmiosAddressToAddress(v.address))(function (address$prime) {
        return Control_Bind.bind(Data_Maybe.bindMaybe)(Data_Traversable.traverse(Data_Traversable.traversableMaybe)(Data_Maybe.applicativeMaybe)(ogmiosDatumHashToDatumHash)(v.datumHash))(function (dh) {
            return Control_Bind.bind(Data_Maybe.bindMaybe)(Data_Traversable.traverse(Data_Traversable.traversableMaybe)(Data_Maybe.applicativeMaybe)(ogmiosDatumToDatum)(Control_Apply.applySecond(Data_Maybe.applyMaybe)(Control_Alternative.guard(Data_Maybe.alternativeMaybe)(Data_Maybe.isNothing(v.datumHash)))(v.datum)))(function (d) {
                return Control_Applicative.pure(Data_Maybe.applicativeMaybe)(Data_Newtype.wrap()({
                    address: address$prime,
                    amount: v.value,
                    datum: toOutputDatum(d)(dh),
                    scriptRef: v.script
                }));
            });
        });
    });
};
var datumToOgmiosDatum = function (v) {
    return Data_Functor.mapFlipped(Data_Maybe.functorMaybe)(Serialization_PlutusData.convertPlutusData(v))((function () {
        var $59 = Untagged_Union.asOneOf();
        return function ($60) {
            return Types_ByteArray.byteArrayToHex(Serialization.toBytes($59($60)));
        };
    })());
};
var datumHashToOgmiosDatumHash = (function () {
    var $61 = Data_Newtype.unwrap();
    return function ($62) {
        return Types_ByteArray.byteArrayToHex($61($62));
    };
})();
var scriptOutputToOgmiosTxOut = function (networkId) {
    return function (v) {
        var address = Address.addressToOgmiosAddress(Scripts.validatorHashEnterpriseAddress(networkId)(v.validatorHash));
        if (v.datum instanceof Types_UnbalancedTransaction.ScriptDatum) {
            return {
                address: address,
                value: v.value,
                datumHash: Data_Maybe.Nothing.value,
                datum: datumToOgmiosDatum(v.datum.value0),
                script: Data_Maybe.Nothing.value
            };
        };
        if (v.datum instanceof Types_UnbalancedTransaction.ScriptDatumHash) {
            return {
                address: address,
                value: v.value,
                datumHash: new Data_Maybe.Just(datumHashToOgmiosDatumHash(v.datum.value0)),
                datum: Data_Maybe.Nothing.value,
                script: Data_Maybe.Nothing.value
            };
        };
        throw new Error("Failed pattern match at TxOutput (line 127, column 5 - line 141, column 10): " + [ v.datum.constructor.name ]);
    };
};
var transactionOutputToOgmiosTxOut = function (v) {
    return {
        address: Address.addressToOgmiosAddress(v.address),
        value: v.amount,
        datumHash: Data_Functor.map(Data_Maybe.functorMaybe)(datumHashToOgmiosDatumHash)(Types_OutputDatum.outputDatumDataHash(v.datum)),
        datum: Control_Bind.bindFlipped(Data_Maybe.bindMaybe)(datumToOgmiosDatum)(Types_OutputDatum.outputDatumDatum(v.datum)),
        script: v.scriptRef
    };
};
module.exports = {
    datumHashToOgmiosDatumHash: datumHashToOgmiosDatumHash,
    ogmiosDatumHashToDatumHash: ogmiosDatumHashToDatumHash,
    ogmiosTxOutToScriptOutput: ogmiosTxOutToScriptOutput,
    ogmiosTxOutToTransactionOutput: ogmiosTxOutToTransactionOutput,
    scriptOutputToOgmiosTxOut: scriptOutputToOgmiosTxOut,
    scriptOutputToTransactionOutput: scriptOutputToTransactionOutput,
    transactionInputToTxOutRef: transactionInputToTxOutRef,
    transactionOutputToOgmiosTxOut: transactionOutputToOgmiosTxOut,
    transactionOutputToScriptOutput: transactionOutputToScriptOutput,
    txOutRefToTransactionInput: txOutRefToTransactionInput
};
