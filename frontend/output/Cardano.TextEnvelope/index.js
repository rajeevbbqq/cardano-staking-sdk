// Generated by purs version 0.14.5
"use strict";
var Aeson = require("../Aeson/index.js");
var Control_Applicative = require("../Control.Applicative/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Control_Monad_Error_Class = require("../Control.Monad.Error.Class/index.js");
var Data_Argonaut_Decode_Error = require("../Data.Argonaut.Decode.Error/index.js");
var Data_Bifunctor = require("../Data.Bifunctor/index.js");
var Data_Either = require("../Data.Either/index.js");
var Data_Eq = require("../Data.Eq/index.js");
var Data_Newtype = require("../Data.Newtype/index.js");
var Data_Show = require("../Data.Show/index.js");
var Types_ByteArray = require("../Types.ByteArray/index.js");
var Types_Cbor = require("../Types.Cbor/index.js");
var PlutusScriptV1 = (function () {
    function PlutusScriptV1() {

    };
    PlutusScriptV1.value = new PlutusScriptV1();
    return PlutusScriptV1;
})();
var PlutusScriptV2 = (function () {
    function PlutusScriptV2() {

    };
    PlutusScriptV2.value = new PlutusScriptV2();
    return PlutusScriptV2;
})();
var PaymentSigningKeyShelleyed25519 = (function () {
    function PaymentSigningKeyShelleyed25519() {

    };
    PaymentSigningKeyShelleyed25519.value = new PaymentSigningKeyShelleyed25519();
    return PaymentSigningKeyShelleyed25519;
})();
var StakeSigningKeyShelleyed25519 = (function () {
    function StakeSigningKeyShelleyed25519() {

    };
    StakeSigningKeyShelleyed25519.value = new StakeSigningKeyShelleyed25519();
    return StakeSigningKeyShelleyed25519;
})();
var JsonDecodeError = (function () {
    function JsonDecodeError(value0) {
        this.value0 = value0;
    };
    JsonDecodeError.create = function (value0) {
        return new JsonDecodeError(value0);
    };
    return JsonDecodeError;
})();
var CborParseError = (function () {
    function CborParseError(value0) {
        this.value0 = value0;
    };
    CborParseError.create = function (value0) {
        return new CborParseError(value0);
    };
    return CborParseError;
})();
var TextEnvelope = function (x) {
    return x;
};
var showTextEnvelopeType = {
    show: function (v) {
        if (v instanceof PlutusScriptV1) {
            return "PlutusScriptV1";
        };
        if (v instanceof PlutusScriptV2) {
            return "PlutusScriptV2";
        };
        if (v instanceof PaymentSigningKeyShelleyed25519) {
            return "PaymentSigningKeyShelley_ed25519";
        };
        if (v instanceof StakeSigningKeyShelleyed25519) {
            return "StakeSigningKeyShelley_ed25519";
        };
        throw new Error("Failed pattern match at Cardano.TextEnvelope (line 41, column 10 - line 45, column 70): " + [ v.constructor.name ]);
    }
};
var newtypeTextEnvelope_ = {
    Coercible0: function () {
        return undefined;
    }
};
var eqTextEnvelopeType = {
    eq: function (x) {
        return function (y) {
            if (x instanceof PlutusScriptV1 && y instanceof PlutusScriptV1) {
                return true;
            };
            if (x instanceof PlutusScriptV2 && y instanceof PlutusScriptV2) {
                return true;
            };
            if (x instanceof PaymentSigningKeyShelleyed25519 && y instanceof PaymentSigningKeyShelleyed25519) {
                return true;
            };
            if (x instanceof StakeSigningKeyShelleyed25519 && y instanceof StakeSigningKeyShelleyed25519) {
                return true;
            };
            return false;
        };
    }
};
var decodeAesonTextEnvelopeTy = {
    decodeAeson: function (aeson) {
        return Control_Bind.bind(Data_Either.bindEither)(Aeson.decodeAeson(Aeson.decodeAesonString)(aeson))(function (v) {
            if (v === "PlutusScriptV1") {
                return Control_Applicative.pure(Data_Either.applicativeEither)(PlutusScriptV1.value);
            };
            if (v === "PlutusScriptV2") {
                return Control_Applicative.pure(Data_Either.applicativeEither)(PlutusScriptV2.value);
            };
            if (v === "PaymentSigningKeyShelley_ed25519") {
                return Control_Applicative.pure(Data_Either.applicativeEither)(PaymentSigningKeyShelleyed25519.value);
            };
            if (v === "StakeSigningKeyShelley_ed25519") {
                return Control_Applicative.pure(Data_Either.applicativeEither)(StakeSigningKeyShelleyed25519.value);
            };
            return Control_Monad_Error_Class.throwError(Control_Monad_Error_Class.monadThrowEither)(new Data_Argonaut_Decode_Error.TypeMismatch("TextEnvelopeType"));
        });
    }
};
var printTextEnvelopeDecodeError = function (v) {
    if (v instanceof JsonDecodeError) {
        return Data_Argonaut_Decode_Error.printJsonDecodeError(v.value0);
    };
    if (v instanceof CborParseError) {
        return Data_Show.show(Types_Cbor.showCborParseError)(v.value0);
    };
    throw new Error("Failed pattern match at Cardano.TextEnvelope (line 91, column 32 - line 93, column 33): " + [ v.constructor.name ]);
};
var decodeTextEnvelope = function (aeson) {
    return Control_Bind.bind(Data_Either.bindEither)(Data_Bifunctor.lmap(Data_Bifunctor.bifunctorEither)(JsonDecodeError.create)(Aeson.decodeAeson(Aeson.decodeAesonRecord(Aeson.gDecodeAesonCons(Aeson.decodeAesonField1(Aeson.decodeAesonString))(Aeson.gDecodeAesonCons(Aeson.decodeAesonField1(Aeson.decodeAesonString))(Aeson.gDecodeAesonCons(Aeson.decodeAesonField1(decodeAesonTextEnvelopeTy))(Aeson.gDecodeAesonRowNil)({
        reflectSymbol: function () {
            return "type";
        }
    })()())({
        reflectSymbol: function () {
            return "description";
        }
    })()())({
        reflectSymbol: function () {
            return "cborHex";
        }
    })()())())(aeson)))(function (v) {
        return Control_Bind.bind(Data_Either.bindEither)(Data_Either.note(JsonDecodeError.create(new Data_Argonaut_Decode_Error.TypeMismatch("Hex")))(Types_ByteArray.hexToByteArray(v.cborHex)))(function (cborBa) {
            return Control_Bind.bind(Data_Either.bindEither)(Data_Bifunctor.lmap(Data_Bifunctor.bifunctorEither)(CborParseError.create)(Types_Cbor.toByteArray(Data_Newtype.wrap()(Data_Newtype.wrap()(cborBa)))))(function (ba) {
                return Control_Applicative.pure(Data_Either.applicativeEither)(Data_Newtype.wrap()({
                    type_: v.type,
                    description: v.description,
                    bytes: ba
                }));
            });
        });
    });
};
var textEnvelopeBytes = function (json) {
    return function (ty) {
        return Control_Bind.bind(Data_Either.bindEither)(Data_Bifunctor.lmap(Data_Bifunctor.bifunctorEither)(JsonDecodeError.create)(Aeson.parseJsonStringToAeson(json)))(function (aeson) {
            return Control_Bind.bind(Data_Either.bindEither)(decodeTextEnvelope(aeson))(function (v) {
                return Control_Bind.discard(Control_Bind.discardUnit)(Data_Either.bindEither)(Control_Applicative.unless(Data_Either.applicativeEither)(Data_Eq.eq(eqTextEnvelopeType)(v.type_)(ty))(Control_Monad_Error_Class.throwError(Control_Monad_Error_Class.monadThrowEither)(JsonDecodeError.create(Data_Argonaut_Decode_Error.TypeMismatch.create(Data_Show.show(showTextEnvelopeType)(ty))))))(function () {
                    return Control_Applicative.pure(Data_Either.applicativeEither)(v.bytes);
                });
            });
        });
    };
};
module.exports = {
    decodeTextEnvelope: decodeTextEnvelope,
    printTextEnvelopeDecodeError: printTextEnvelopeDecodeError,
    textEnvelopeBytes: textEnvelopeBytes,
    TextEnvelope: TextEnvelope,
    PlutusScriptV1: PlutusScriptV1,
    PlutusScriptV2: PlutusScriptV2,
    PaymentSigningKeyShelleyed25519: PaymentSigningKeyShelleyed25519,
    StakeSigningKeyShelleyed25519: StakeSigningKeyShelleyed25519,
    JsonDecodeError: JsonDecodeError,
    CborParseError: CborParseError,
    eqTextEnvelopeType: eqTextEnvelopeType,
    showTextEnvelopeType: showTextEnvelopeType,
    decodeAesonTextEnvelopeTy: decodeAesonTextEnvelopeTy,
    newtypeTextEnvelope_: newtypeTextEnvelope_
};
