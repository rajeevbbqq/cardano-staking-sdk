// Generated by purs version 0.14.5
"use strict";
var $foreign = require("./foreign.js");
var Control_Apply = require("../Control.Apply/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Data_Foldable = require("../Data.Foldable/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_Map_Internal = require("../Data.Map.Internal/index.js");
var Data_Newtype = require("../Data.Newtype/index.js");
var Data_Traversable = require("../Data.Traversable/index.js");
var Data_Tuple = require("../Data.Tuple/index.js");
var Data_Unfoldable = require("../Data.Unfoldable/index.js");
var Effect = require("../Effect/index.js");
var FfiHelpers = require("../FfiHelpers/index.js");
var Helpers = require("../Helpers/index.js");
var Serialization_NativeScript = require("../Serialization.NativeScript/index.js");
var Serialization_PlutusScript = require("../Serialization.PlutusScript/index.js");
var Serialization_WitnessSet = require("../Serialization.WitnessSet/index.js");
var Types_BigNum = require("../Types.BigNum/index.js");
var Types_TransactionMetadata = require("../Types.TransactionMetadata/index.js");
var convertTransactionMetadatum = function (v) {
    if (v instanceof Types_TransactionMetadata.MetadataMap) {
        return Control_Bind.bindFlipped(Effect.bindEffect)($foreign.newMetadataMap(FfiHelpers.containerHelper))(Data_Traversable["for"](Effect.applicativeEffect)(Data_Traversable.traversableArray)(Data_Map_Internal.toUnfoldable(Data_Unfoldable.unfoldableArray)(v.value0))(function (v1) {
            return Control_Apply.apply(Effect.applyEffect)(Data_Functor.map(Effect.functorEffect)(Data_Tuple.Tuple.create)(convertTransactionMetadatum(v1.value0)))(convertTransactionMetadatum(v1.value1));
        }));
    };
    if (v instanceof Types_TransactionMetadata.MetadataList) {
        return Control_Bind.bindFlipped(Effect.bindEffect)($foreign.newMetadataList(FfiHelpers.containerHelper))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Effect.applicativeEffect)(convertTransactionMetadatum)(v.value0));
    };
    if (v instanceof Types_TransactionMetadata.Int) {
        return $foreign.newMetadataInt(v.value0);
    };
    if (v instanceof Types_TransactionMetadata.Bytes) {
        return $foreign.newMetadataBytes(v.value0);
    };
    if (v instanceof Types_TransactionMetadata.Text) {
        return $foreign.newMetadataText(v.value0);
    };
    throw new Error("Failed pattern match at Serialization.AuxiliaryData (line 114, column 31 - line 123, column 38): " + [ v.constructor.name ]);
};
var convertGeneralTransactionMetadata = function (v) {
    return Control_Bind.bindFlipped(Effect.bindEffect)($foreign.newGeneralTransactionMetadata(FfiHelpers.containerHelper))(Data_Traversable["for"](Effect.applicativeEffect)(Data_Traversable.traversableArray)(Data_Map_Internal.toUnfoldable(Data_Unfoldable.unfoldableArray)(v))(function (v1) {
        return function __do() {
            var label = Helpers.fromJustEff("convertGeneralTransactionMetadata: failing to convert MetadataumLabel")(Types_BigNum.fromBigInt(v1.value0))();
            var datum = convertTransactionMetadatum(v1.value1)();
            return new Data_Tuple.Tuple(label, datum);
        };
    }));
};
var convertAuxiliaryData = function (v) {
    return function __do() {
        var ad = $foreign.newAuxiliaryData();
        Data_Foldable.for_(Effect.applicativeEffect)(Data_Foldable.foldableMaybe)(v.metadata)(Control_Bind.composeKleisli(Effect.bindEffect)(convertGeneralTransactionMetadata)($foreign.setAuxiliaryDataGeneralTransactionMetadata(ad)))();
        Data_Foldable.for_(Effect.applicativeEffect)(Data_Foldable.foldableMaybe)(v.nativeScripts)(Control_Bind.composeKleisli(Effect.bindEffect)((function () {
            var $22 = Helpers.fromJustEff("convertAuxiliaryData: failed to convert NativeScripts");
            return function ($23) {
                return $22(Serialization_NativeScript.convertNativeScripts($23));
            };
        })())($foreign.setAuxiliaryDataNativeScripts(ad)))();
        Data_Foldable.for_(Effect.applicativeEffect)(Data_Foldable.foldableMaybe)(v.plutusScripts)(function (ps) {
            return function __do() {
                var scripts = Serialization_WitnessSet.newPlutusScripts();
                Data_Foldable.for_(Effect.applicativeEffect)(Data_Foldable.foldableArray)(ps)((function () {
                    var $24 = Serialization_WitnessSet.addPlutusScript(scripts);
                    return function ($25) {
                        return $24(Serialization_PlutusScript.convertPlutusScript($25));
                    };
                })())();
                return $foreign.setAuxiliaryDataPlutusScripts(ad)(scripts)();
            };
        })();
        return ad;
    };
};
var hashAuxiliaryData = (function () {
    var $26 = Data_Functor.map(Effect.functorEffect)((function () {
        var $28 = Data_Newtype.wrap();
        return function ($29) {
            return $28($foreign["_hashAuxiliaryData"]($29));
        };
    })());
    return function ($27) {
        return $26(convertAuxiliaryData($27));
    };
})();
module.exports = {
    convertAuxiliaryData: convertAuxiliaryData,
    hashAuxiliaryData: hashAuxiliaryData
};
