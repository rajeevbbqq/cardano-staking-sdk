// Generated by purs version 0.14.5
"use strict";
var Control_Alt = require("../Control.Alt/index.js");
var Control_Applicative = require("../Control.Applicative/index.js");
var Control_Apply = require("../Control.Apply/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Control_Category = require("../Control.Category/index.js");
var Data_Array = require("../Data.Array/index.js");
var Data_Array_NonEmpty = require("../Data.Array.NonEmpty/index.js");
var Data_Boolean = require("../Data.Boolean/index.js");
var Data_Either = require("../Data.Either/index.js");
var Data_Eq = require("../Data.Eq/index.js");
var Data_Exists = require("../Data.Exists/index.js");
var Data_Foldable = require("../Data.Foldable/index.js");
var Data_Function = require("../Data.Function/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_Generic_Rep = require("../Data.Generic.Rep/index.js");
var Data_List = require("../Data.List/index.js");
var Data_List_Types = require("../Data.List.Types/index.js");
var Data_Maybe = require("../Data.Maybe/index.js");
var Data_Monoid = require("../Data.Monoid/index.js");
var Data_Newtype = require("../Data.Newtype/index.js");
var Data_Ord = require("../Data.Ord/index.js");
var Data_Ordering = require("../Data.Ordering/index.js");
var Data_Semigroup = require("../Data.Semigroup/index.js");
var Data_Show = require("../Data.Show/index.js");
var Data_Show_Generic = require("../Data.Show.Generic/index.js");
var Data_Traversable = require("../Data.Traversable/index.js");
var Effect = require("../Effect/index.js");
var Options_Applicative_Builder = require("../Options.Applicative.Builder/index.js");
var Options_Applicative_Builder_Internal = require("../Options.Applicative.Builder.Internal/index.js");
var Options_Applicative_Common = require("../Options.Applicative.Common/index.js");
var Options_Applicative_Help_Chunk = require("../Options.Applicative.Help.Chunk/index.js");
var Options_Applicative_Internal = require("../Options.Applicative.Internal/index.js");
var Options_Applicative_Internal_Utils = require("../Options.Applicative.Internal.Utils/index.js");
var Options_Applicative_Types = require("../Options.Applicative.Types/index.js");
var Text_PrettyPrint_Leijen = require("../Text.PrettyPrint.Leijen/index.js");
var Standard = (function () {
    function Standard() {

    };
    Standard.value = new Standard();
    return Standard;
})();
var Enriched = (function () {
    function Enriched(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Enriched.create = function (value0) {
        return function (value1) {
            return new Enriched(value0, value1);
        };
    };
    return Enriched;
})();
var zshCompletionScript = function (prog) {
    return function (progn) {
        return Control_Applicative.pure(Effect.applicativeEffect)([ "#compdef " + progn, "", "local request", "local completions", "local word", "local index=$((CURRENT - 1))", "", "request=(--bash-completion-enriched --bash-completion-index $index)", "for arg in ${words[@]}; do", "  request=(${request[@]} --bash-completion-word $arg)", "done", "", "IFS=$'\\n' completions=($( " + (prog + " \"${request[@]}\" ))"), "", "for word in $completions; do", "  local -a parts", "", "  # Split the line at a tab if there is one.", "  IFS=$'\\t' parts=($( echo $word ))", "", "  if [[ -n $parts[2] ]]; then", "     if [[ $word[1] == \"-\" ]]; then", "       local desc=(\"$parts[1] ($parts[2])\")", "       compadd -d desc -- $parts[1]", "     else", "       local desc=($(print -f  \"%-019s -- %s\" $parts[1] $parts[2]))", "       compadd -l -d desc -- $parts[1]", "     fi", "  else", "    compadd -f -- $word", "  fi", "done" ]);
    };
};
var richnessGeneric = {
    to: function (x) {
        if (x instanceof Data_Generic_Rep.Inl) {
            return Standard.value;
        };
        if (x instanceof Data_Generic_Rep.Inr) {
            return new Enriched(x.value0.value0, x.value0.value1);
        };
        throw new Error("Failed pattern match at Options.Applicative.BashCompletion (line 46, column 1 - line 46, column 54): " + [ x.constructor.name ]);
    },
    from: function (x) {
        if (x instanceof Standard) {
            return new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value);
        };
        if (x instanceof Enriched) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Product(x.value0, x.value1));
        };
        throw new Error("Failed pattern match at Options.Applicative.BashCompletion (line 46, column 1 - line 46, column 54): " + [ x.constructor.name ]);
    }
};
var richnessShow = {
    show: Data_Show_Generic.genericShow(richnessGeneric)(Data_Show_Generic.genericShowSum(Data_Show_Generic.genericShowConstructor(Data_Show_Generic.genericShowArgsNoArguments)({
        reflectSymbol: function () {
            return "Standard";
        }
    }))(Data_Show_Generic.genericShowConstructor(Data_Show_Generic.genericShowArgsProduct(Data_Show_Generic.genericShowArgsArgument(Data_Show.showInt))(Data_Show_Generic.genericShowArgsArgument(Data_Show.showInt)))({
        reflectSymbol: function () {
            return "Enriched";
        }
    })))
};
var richnessEq = {
    eq: function (x) {
        return function (y) {
            if (x instanceof Standard && y instanceof Standard) {
                return true;
            };
            if (x instanceof Enriched && y instanceof Enriched) {
                return x.value0 === y.value0 && x.value1 === y.value1;
            };
            return false;
        };
    }
};
var richnessOrd = {
    compare: function (x) {
        return function (y) {
            if (x instanceof Standard && y instanceof Standard) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Standard) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Standard) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Enriched && y instanceof Enriched) {
                var v = Data_Ord.compare(Data_Ord.ordInt)(x.value0)(y.value0);
                if (v instanceof Data_Ordering.LT) {
                    return Data_Ordering.LT.value;
                };
                if (v instanceof Data_Ordering.GT) {
                    return Data_Ordering.GT.value;
                };
                return Data_Ord.compare(Data_Ord.ordInt)(x.value1)(y.value1);
            };
            throw new Error("Failed pattern match at Options.Applicative.BashCompletion (line 45, column 1 - line 45, column 44): " + [ x.constructor.name, y.constructor.name ]);
        };
    },
    Eq0: function () {
        return richnessEq;
    }
};
var fishCompletionScript = function (prog) {
    return function (progn) {
        return Control_Applicative.pure(Effect.applicativeEffect)([ " function _" + progn, "    set -l cl (commandline --tokenize --current-process)", "    # Hack around fish issue #3934", "    set -l cn (commandline --tokenize --cut-at-cursor --current-process)", "    set -l cn (count $cn)", "    set -l tmpline --bash-completion-enriched --bash-completion-index $cn", "    for arg in $cl", "      set tmpline $tmpline --bash-completion-word $arg", "    end", "    for opt in (" + (prog + " $tmpline)"), "      if test -d $opt", "        echo -E \"$opt/\"", "      else", "        echo -E \"$opt\"", "      end", "    end", "end", "", "complete --no-files --command " + (progn + (" --arguments '(_" + (progn + ")'"))) ]);
    };
};
var bashCompletionScript = function (prog) {
    return function (progn) {
        return Control_Applicative.pure(Effect.applicativeEffect)([ "_" + (progn + "()"), "{", "    local CMDLINE", "    local IFS=$'\\n'", "    CMDLINE=(--bash-completion-index $COMP_CWORD)", "", "    for arg in ${COMP_WORDS[@]}; do", "        CMDLINE=(${CMDLINE[@]} --bash-completion-word $arg)", "    done", "", "    COMPREPLY=( $(" + (prog + " \"${CMDLINE[@]}\") )"), "}", "", "complete -o filenames -F _" + (progn + (" " + progn)) ]);
    };
};
var arraySplitAt = function (idx) {
    return function (arr) {
        if (idx === 0) {
            return {
                init: [  ],
                rest: arr
            };
        };
        return {
            init: Data_Array.slice(0)(idx)(arr),
            rest: Data_Array.slice(idx)(Data_Array.length(arr))(arr)
        };
    };
};
var bashCompletionQuery = function (pinfo) {
    return function (pprefs) {
        return function (richness) {
            return function (ws) {
                return function (i) {
                    return function (v) {
                        var v1 = arraySplitAt(i)(ws);
                        var run_completer = function (c) {
                            return Data_Newtype.un()(Options_Applicative_Types.Completer)(c)(Data_Maybe.fromMaybe("")(Data_Array.head(v1.rest)));
                        };
                        var render_line = function (len) {
                            return function (doc) {
                                var v2 = Data_Functor.map(Data_Maybe.functorMaybe)(Data_Array_NonEmpty.uncons)(Data_Array_NonEmpty.fromArray(Options_Applicative_Internal_Utils.lines(Text_PrettyPrint_Leijen.displayS(Text_PrettyPrint_Leijen.renderPretty(1.0)(len)(doc)))));
                                if (v2 instanceof Data_Maybe.Nothing) {
                                    return "";
                                };
                                if (v2 instanceof Data_Maybe.Just && v2.value0.tail.length === 0) {
                                    return v2.value0.head;
                                };
                                if (v2 instanceof Data_Maybe.Just) {
                                    return v2.value0.head + "...";
                                };
                                throw new Error("Failed pattern match at Options.Applicative.BashCompletion (line 162, column 27 - line 165, column 43): " + [ v2.constructor.name ]);
                            };
                        };
                        var is_completion = (function () {
                            var v2 = Data_Array.head(v1.rest);
                            if (v2 instanceof Data_Maybe.Just) {
                                return Options_Applicative_Internal_Utils.startsWith(v2.value0);
                            };
                            if (v2 instanceof Data_Maybe.Nothing) {
                                return Data_Function["const"](true);
                            };
                            throw new Error("Failed pattern match at Options.Applicative.BashCompletion (line 175, column 7 - line 177, column 30): " + [ v2.constructor.name ]);
                        })();
                        var filter_names = Data_Array.filter(is_completion);
                        var show_names = (function () {
                            var $84 = Data_Functor.map(Data_Functor.functorArray)(Options_Applicative_Common.showOption);
                            return function ($85) {
                                return filter_names($84($85));
                            };
                        })();
                        var compl = Options_Applicative_Common.runParserInfo(Options_Applicative_Internal.completionMonadP)(pinfo)(Data_List.fromFoldable(Data_Foldable.foldableArray)(Data_Array.drop(1)(v1.init)));
                        var add_opt_help = function (dictFunctor) {
                            return function (opt) {
                                if (richness instanceof Standard) {
                                    return Control_Category.identity(Control_Category.categoryFn);
                                };
                                if (richness instanceof Enriched) {
                                    return Data_Functor.map(dictFunctor)(function (o) {
                                        var h = Data_Newtype.un()(Options_Applicative_Help_Chunk.Chunk)(Options_Applicative_Types.optHelp(opt));
                                        return Data_Maybe.maybe(o)(function (h$prime) {
                                            return o + ("\x09" + render_line(richness.value0)(h$prime));
                                        })(h);
                                    });
                                };
                                throw new Error("Failed pattern match at Options.Applicative.BashCompletion (line 138, column 24 - line 143, column 79): " + [ richness.constructor.name ]);
                            };
                        };
                        var add_cmd_help = function (dictFunctor) {
                            return function (p) {
                                if (richness instanceof Standard) {
                                    return Control_Category.identity(Control_Category.categoryFn);
                                };
                                if (richness instanceof Enriched) {
                                    return Data_Functor.map(dictFunctor)(function (cmd) {
                                        var h = Control_Bind.bind(Data_Maybe.bindMaybe)(p(cmd))((function () {
                                            var $86 = Data_Newtype.un()(Options_Applicative_Help_Chunk.Chunk);
                                            var $87 = Data_Newtype.un()(Options_Applicative_Types.ParserInfo);
                                            return function ($88) {
                                                return $86((function (v2) {
                                                    return v2.infoProgDesc;
                                                })($87($88)));
                                            };
                                        })());
                                        return Data_Maybe.maybe(cmd)(function (h$prime) {
                                            return cmd + ("\x09" + render_line(richness.value1)(h$prime));
                                        })(h);
                                    });
                                };
                                throw new Error("Failed pattern match at Options.Applicative.BashCompletion (line 148, column 22 - line 153, column 85): " + [ richness.constructor.name ]);
                            };
                        };
                        var opt_completions = function (argPolicy) {
                            return function (hinfo) {
                                return function (opt) {
                                    var v2 = (Data_Newtype.un()(Options_Applicative_Types.Option)(opt)).optMain;
                                    if (v2 instanceof Options_Applicative_Types.OptReader) {
                                        if (Data_Eq.notEq(Options_Applicative_Types.argPolicyEq)(argPolicy)(Options_Applicative_Types.AllPositionals.value)) {
                                            return Control_Applicative.pure(Effect.applicativeEffect)(add_opt_help(Data_Functor.functorArray)(opt)(show_names(v2.value0)));
                                        };
                                        if (Data_Boolean.otherwise) {
                                            return Control_Applicative.pure(Effect.applicativeEffect)([  ]);
                                        };
                                    };
                                    if (v2 instanceof Options_Applicative_Types.FlagReader) {
                                        if (Data_Eq.notEq(Options_Applicative_Types.argPolicyEq)(argPolicy)(Options_Applicative_Types.AllPositionals.value)) {
                                            return Control_Applicative.pure(Effect.applicativeEffect)(add_opt_help(Data_Functor.functorArray)(opt)(show_names(v2.value0)));
                                        };
                                        if (Data_Boolean.otherwise) {
                                            return Control_Applicative.pure(Effect.applicativeEffect)([  ]);
                                        };
                                    };
                                    if (v2 instanceof Options_Applicative_Types.ArgReader) {
                                        if ((Data_Newtype.un()(Options_Applicative_Types.OptHelpInfo)(hinfo)).hinfoUnreachableArgs) {
                                            return Control_Applicative.pure(Effect.applicativeEffect)([  ]);
                                        };
                                        if (Data_Boolean.otherwise) {
                                            return run_completer((Data_Newtype.un()(Options_Applicative_Types.CReader)(v2.value0)).crCompleter);
                                        };
                                    };
                                    if (v2 instanceof Options_Applicative_Types.CmdReader) {
                                        if ((Data_Newtype.un()(Options_Applicative_Types.OptHelpInfo)(hinfo)).hinfoUnreachableArgs) {
                                            return Control_Applicative.pure(Effect.applicativeEffect)([  ]);
                                        };
                                        if (Data_Boolean.otherwise) {
                                            return Control_Applicative.pure(Effect.applicativeEffect)(add_cmd_help(Data_Functor.functorArray)(v2.value2)(filter_names(v2.value1)));
                                        };
                                    };
                                    throw new Error("Failed pattern match at Options.Applicative.BashCompletion (line 113, column 43 - line 133, column 53): " + [ v2.constructor.name ]);
                                };
                            };
                        };
                        var list_options = function (a) {
                            var $89 = Data_Functor.map(Effect.functorEffect)(Data_Foldable.fold(Data_Foldable.foldableArray)(Data_Monoid.monoidArray));
                            var $90 = Data_Traversable.sequence(Data_Traversable.traversableArray)(Effect.applicativeEffect);
                            var $91 = Options_Applicative_Common.mapParser(opt_completions(a));
                            return function ($92) {
                                return $89($90($91($92)));
                            };
                        };
                        var v2 = Options_Applicative_Internal.runCompletion(compl)(pprefs);
                        if (v2 instanceof Data_Maybe.Just && v2.value0 instanceof Data_Either.Left) {
                            return Data_Exists.runExists(function (p) {
                                return list_options(v2.value0.value0.value1)(p);
                            })(v2.value0.value0.value0.value0);
                        };
                        if (v2 instanceof Data_Maybe.Just && v2.value0 instanceof Data_Either.Right) {
                            return run_completer(v2.value0.value0);
                        };
                        if (v2 instanceof Data_Maybe.Nothing) {
                            return Control_Applicative.pure(Effect.applicativeEffect)([  ]);
                        };
                        throw new Error("Failed pattern match at Options.Applicative.BashCompletion (line 83, column 52 - line 89, column 15): " + [ v2.constructor.name ]);
                    };
                };
            };
        };
    };
};
var bashCompletionParser = function (pinfo) {
    return function (pprefs) {
        var failure = function (opts) {
            return {
                execCompletion: function (progn) {
                    return Data_Functor.map(Effect.functorEffect)(Options_Applicative_Internal_Utils.unLines(Data_Foldable.foldableArray))(opts(progn));
                }
            };
        };
        var complParser = Control_Alt.alt(Options_Applicative_Types.parserAlt)(Control_Alt.alt(Options_Applicative_Types.parserAlt)(Control_Alt.alt(Options_Applicative_Types.parserAlt)(Data_Functor.map(Options_Applicative_Types.parserFunctor)(failure)(Control_Apply.apply(Options_Applicative_Types.parserApply)(Control_Apply.apply(Options_Applicative_Types.parserApply)(Data_Functor.map(Options_Applicative_Types.parserFunctor)(bashCompletionQuery(pinfo)(pprefs))(Control_Alt.alt(Options_Applicative_Types.parserAlt)(Control_Apply.apply(Options_Applicative_Types.parserApply)(Control_Apply.apply(Options_Applicative_Types.parserApply)(Options_Applicative_Builder["flag'"](Enriched.create)(Data_Semigroup.append(Options_Applicative_Builder_Internal.modSemigroup)(Options_Applicative_Builder["long"](Options_Applicative_Builder_Internal.flagFieldsHasName)("bash-completion-enriched"))(Options_Applicative_Builder_Internal.internal)))(Options_Applicative_Builder.option(Options_Applicative_Builder["int"])(Data_Semigroup.append(Options_Applicative_Builder_Internal.modSemigroup)(Data_Semigroup.append(Options_Applicative_Builder_Internal.modSemigroup)(Options_Applicative_Builder["long"](Options_Applicative_Builder_Internal.optionFieldsHasName)("bash-completion-option-desc-length"))(Options_Applicative_Builder_Internal.internal))(Options_Applicative_Builder.value(Options_Applicative_Builder_Internal.optionFieldsHasValue)(40)))))(Options_Applicative_Builder.option(Options_Applicative_Builder["int"])(Data_Semigroup.append(Options_Applicative_Builder_Internal.modSemigroup)(Data_Semigroup.append(Options_Applicative_Builder_Internal.modSemigroup)(Options_Applicative_Builder["long"](Options_Applicative_Builder_Internal.optionFieldsHasName)("bash-completion-command-desc-length"))(Options_Applicative_Builder_Internal.internal))(Options_Applicative_Builder.value(Options_Applicative_Builder_Internal.optionFieldsHasValue)(40)))))(Control_Applicative.pure(Options_Applicative_Types.parserApplicative)(Standard.value))))(Data_Functor.map(Options_Applicative_Types.parserFunctor)(Data_Array.fromFoldable(Data_List_Types.foldableList))(Options_Applicative_Types.many(Options_Applicative_Builder.strOption(Data_Semigroup.append(Options_Applicative_Builder_Internal.modSemigroup)(Options_Applicative_Builder["long"](Options_Applicative_Builder_Internal.optionFieldsHasName)("bash-completion-word"))(Options_Applicative_Builder_Internal.internal))))))(Options_Applicative_Builder.option(Options_Applicative_Builder["int"])(Data_Semigroup.append(Options_Applicative_Builder_Internal.modSemigroup)(Options_Applicative_Builder["long"](Options_Applicative_Builder_Internal.optionFieldsHasName)("bash-completion-index"))(Options_Applicative_Builder_Internal.internal)))))(Data_Functor.map(Options_Applicative_Types.parserFunctor)(failure)(Data_Functor.map(Options_Applicative_Types.parserFunctor)(bashCompletionScript)(Options_Applicative_Builder.strOption(Data_Semigroup.append(Options_Applicative_Builder_Internal.modSemigroup)(Options_Applicative_Builder["long"](Options_Applicative_Builder_Internal.optionFieldsHasName)("bash-completion-script"))(Options_Applicative_Builder_Internal.internal))))))(Data_Functor.map(Options_Applicative_Types.parserFunctor)(failure)(Data_Functor.map(Options_Applicative_Types.parserFunctor)(fishCompletionScript)(Options_Applicative_Builder.strOption(Data_Semigroup.append(Options_Applicative_Builder_Internal.modSemigroup)(Options_Applicative_Builder["long"](Options_Applicative_Builder_Internal.optionFieldsHasName)("fish-completion-script"))(Options_Applicative_Builder_Internal.internal))))))(Data_Functor.map(Options_Applicative_Types.parserFunctor)(failure)(Data_Functor.map(Options_Applicative_Types.parserFunctor)(zshCompletionScript)(Options_Applicative_Builder.strOption(Data_Semigroup.append(Options_Applicative_Builder_Internal.modSemigroup)(Options_Applicative_Builder["long"](Options_Applicative_Builder_Internal.optionFieldsHasName)("zsh-completion-script"))(Options_Applicative_Builder_Internal.internal)))));
        return complParser;
    };
};
module.exports = {
    bashCompletionParser: bashCompletionParser
};
