// Generated by purs version 0.14.5
"use strict";
var Control_Alternative = require("../Control.Alternative/index.js");
var Control_Applicative = require("../Control.Applicative/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Control_Category = require("../Control.Category/index.js");
var Data_Array = require("../Data.Array/index.js");
var Data_Array_NonEmpty = require("../Data.Array.NonEmpty/index.js");
var Data_Boolean = require("../Data.Boolean/index.js");
var Data_Eq = require("../Data.Eq/index.js");
var Data_Function = require("../Data.Function/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_HeytingAlgebra = require("../Data.HeytingAlgebra/index.js");
var Data_Maybe = require("../Data.Maybe/index.js");
var Data_Monoid = require("../Data.Monoid/index.js");
var Data_Newtype = require("../Data.Newtype/index.js");
var Data_Semigroup = require("../Data.Semigroup/index.js");
var Data_Tuple = require("../Data.Tuple/index.js");
var Options_Applicative_Common = require("../Options.Applicative.Common/index.js");
var Options_Applicative_Help_Chunk = require("../Options.Applicative.Help.Chunk/index.js");
var Options_Applicative_Help_Types = require("../Options.Applicative.Help.Types/index.js");
var Options_Applicative_Types = require("../Options.Applicative.Types/index.js");
var Text_PrettyPrint_Leijen = require("../Text.PrettyPrint.Leijen/index.js");
var OptDescStyle = function (x) {
    return x;
};
var usageHelp = function (chunk) {
    return Data_Newtype.over()()(Options_Applicative_Help_Types.ParserHelp)(function (v) {
        return {
            helpUsage: chunk,
            helpBody: v.helpBody,
            helpError: v.helpError,
            helpFooter: v.helpFooter,
            helpHeader: v.helpHeader,
            helpSuggestions: v.helpSuggestions
        };
    })(Data_Monoid.mempty(Options_Applicative_Help_Types.parserHelpMonoid));
};
var suggestionsHelp = function (chunk) {
    return Data_Newtype.over()()(Options_Applicative_Help_Types.ParserHelp)(function (v) {
        return {
            helpSuggestions: chunk,
            helpBody: v.helpBody,
            helpError: v.helpError,
            helpFooter: v.helpFooter,
            helpHeader: v.helpHeader,
            helpUsage: v.helpUsage
        };
    })(Data_Monoid.mempty(Options_Applicative_Help_Types.parserHelpMonoid));
};
var newtypeOptDescStyle = {
    Coercible0: function () {
        return undefined;
    }
};
var intersperse = function (sep) {
    var $28 = Data_Array.fold(Data_Monoid.monoidArray);
    var $29 = Data_Array.mapWithIndex(function (idx) {
        return function (e) {
            var $13 = idx === 0;
            if ($13) {
                return [ e ];
            };
            return [ sep, e ];
        };
    });
    return function ($30) {
        return $28($29($30));
    };
};
var optDesc = function (pprefs) {
    return function (style) {
        return function (info) {
            return function (opt) {
                var suffix = (function () {
                    if ((Data_Newtype.un()(Options_Applicative_Types.OptHelpInfo)(info)).hinfoMulti) {
                        return Options_Applicative_Help_Chunk.stringChunk((Data_Newtype.un()(Options_Applicative_Types.ParserPrefs)(pprefs)).prefMultiSuffix);
                    };
                    if (Data_Boolean.otherwise) {
                        return Data_Monoid.mempty(Options_Applicative_Help_Chunk.chunkMonoid(Text_PrettyPrint_Leijen.docSemigroup));
                    };
                    throw new Error("Failed pattern match at Options.Applicative.Help.Core (line 58, column 7 - line 62, column 17): " + [  ]);
                })();
                var show_opt = (function () {
                    if ((Data_Newtype.un()(Options_Applicative_Types.OptHelpInfo)(info)).hinfoDefault && !(Data_Newtype.un()(OptDescStyle)(style)).descOptional) {
                        return false;
                    };
                    if (Data_Eq.eq(Options_Applicative_Types.optVisibilityEq)(Options_Applicative_Types.optVisibility(opt))(Options_Applicative_Types.Hidden.value)) {
                        return (Data_Newtype.un()(OptDescStyle)(style)).descHidden;
                    };
                    if (Data_Boolean.otherwise) {
                        return Data_Eq.eq(Options_Applicative_Types.optVisibilityEq)(Options_Applicative_Types.optVisibility(opt))(Options_Applicative_Types.Visible.value);
                    };
                    throw new Error("Failed pattern match at Options.Applicative.Help.Core (line 51, column 7 - line 57, column 39): " + [  ]);
                })();
                var ns = Options_Applicative_Common.optionNames((Data_Newtype.un()(Options_Applicative_Types.Option)(opt)).optMain);
                var mv = Options_Applicative_Help_Chunk.stringChunk(Options_Applicative_Types.optMetaVar(opt));
                var descs = Data_Functor.map(Data_Functor.functorArray)(function ($31) {
                    return Text_PrettyPrint_Leijen.string(Options_Applicative_Common.showOption($31));
                })(Data_Array.sort(Options_Applicative_Types.optNameOrd)(ns));
                var render = function (chunk) {
                    if (!show_opt) {
                        return Data_Monoid.mempty(Options_Applicative_Help_Chunk.chunkMonoid(Text_PrettyPrint_Leijen.docSemigroup));
                    };
                    if (Options_Applicative_Help_Chunk.isEmpty(chunk) || !(Data_Newtype.un()(OptDescStyle)(style)).descSurround) {
                        return Data_Semigroup.append(Options_Applicative_Help_Chunk.chunkSemigroup(Text_PrettyPrint_Leijen.docSemigroup))(chunk)(suffix);
                    };
                    if ((Data_Newtype.un()(Options_Applicative_Types.OptHelpInfo)(info)).hinfoDefault) {
                        return Data_Semigroup.append(Options_Applicative_Help_Chunk.chunkSemigroup(Text_PrettyPrint_Leijen.docSemigroup))(Data_Functor.map(Options_Applicative_Help_Chunk.chunkFunctor)(Text_PrettyPrint_Leijen.brackets)(chunk))(suffix);
                    };
                    if (Data_Array["null"](Data_Array.drop(1)(descs))) {
                        return Data_Semigroup.append(Options_Applicative_Help_Chunk.chunkSemigroup(Text_PrettyPrint_Leijen.docSemigroup))(chunk)(suffix);
                    };
                    if (Data_Boolean.otherwise) {
                        return Data_Semigroup.append(Options_Applicative_Help_Chunk.chunkSemigroup(Text_PrettyPrint_Leijen.docSemigroup))(Data_Functor.map(Options_Applicative_Help_Chunk.chunkFunctor)(Text_PrettyPrint_Leijen.parens)(chunk))(suffix);
                    };
                    throw new Error("Failed pattern match at Options.Applicative.Help.Core (line 63, column 7 - line 73, column 43): " + [ chunk.constructor.name ]);
                };
                var desc$prime = Options_Applicative_Help_Chunk.chunkBeside(Options_Applicative_Help_Chunk.listToChunk(Text_PrettyPrint_Leijen.docMonoid)(intersperse((Data_Newtype.un()(OptDescStyle)(style)).descSep)(descs)))(mv);
                return Data_Maybe.maybe(Control_Category.identity(Control_Category.categoryFn))(Data_Functor.map(Options_Applicative_Help_Chunk.chunkFunctor))(Options_Applicative_Types.optDescMod(opt))(render(desc$prime));
            };
        };
    };
};
var headerHelp = function (chunk) {
    return Data_Newtype.over()()(Options_Applicative_Help_Types.ParserHelp)(function (v) {
        return {
            helpHeader: chunk,
            helpBody: v.helpBody,
            helpError: v.helpError,
            helpFooter: v.helpFooter,
            helpSuggestions: v.helpSuggestions,
            helpUsage: v.helpUsage
        };
    })(Data_Monoid.mempty(Options_Applicative_Help_Types.parserHelpMonoid));
};
var fullDesc = function (pprefs) {
    var style = {
        descSep: Text_PrettyPrint_Leijen.string(","),
        descHidden: true,
        descOptional: true,
        descSurround: false
    };
    var doc = function (info) {
        return function (opt) {
            var show_def = function (s) {
                return Text_PrettyPrint_Leijen.parens(Text_PrettyPrint_Leijen.appendWithSpace(Text_PrettyPrint_Leijen.string("default:"))(Text_PrettyPrint_Leijen.string(s)));
            };
            var n = optDesc(pprefs)(style)(info)(opt);
            var hdef = Options_Applicative_Help_Chunk.Chunk(Data_Functor.map(Data_Maybe.functorMaybe)(show_def)(Options_Applicative_Types.optShowDefault(opt)));
            var h = Options_Applicative_Types.optHelp(opt);
            return Control_Bind.discard(Control_Bind.discardUnit)(Data_Maybe.bindMaybe)(Control_Alternative.guard(Data_Maybe.alternativeMaybe)(!Options_Applicative_Help_Chunk.isEmpty(n)))(function () {
                return Control_Bind.discard(Control_Bind.discardUnit)(Data_Maybe.bindMaybe)(Control_Alternative.guard(Data_Maybe.alternativeMaybe)(!Options_Applicative_Help_Chunk.isEmpty(h)))(function () {
                    return Control_Applicative.pure(Data_Maybe.applicativeMaybe)(new Data_Tuple.Tuple(Options_Applicative_Help_Chunk.extractChunk(Text_PrettyPrint_Leijen.docMonoid)(n), Text_PrettyPrint_Leijen.align(Options_Applicative_Help_Chunk.extractChunk(Text_PrettyPrint_Leijen.docMonoid)(Options_Applicative_Help_Chunk.chunkBeside(h)(hdef)))));
                });
            });
        };
    };
    var $32 = Options_Applicative_Common.mapParser(doc);
    return function ($33) {
        return Options_Applicative_Help_Chunk.tabulate(Data_Array.catMaybes($32($33)));
    };
};
var footerHelp = function (chunk) {
    return Data_Newtype.over()()(Options_Applicative_Help_Types.ParserHelp)(function (v) {
        return {
            helpFooter: chunk,
            helpBody: v.helpBody,
            helpError: v.helpError,
            helpHeader: v.helpHeader,
            helpSuggestions: v.helpSuggestions,
            helpUsage: v.helpUsage
        };
    })(Data_Monoid.mempty(Options_Applicative_Help_Types.parserHelpMonoid));
};
var fold_tree = function (v) {
    if (v instanceof Options_Applicative_Types.Leaf) {
        return v.value0;
    };
    if (v instanceof Options_Applicative_Types.MultNode) {
        return Data_Array.foldr(function ($34) {
            return Options_Applicative_Help_Chunk.chunkBesideOrBelow(fold_tree($34));
        })(Data_Monoid.mempty(Options_Applicative_Help_Chunk.chunkMonoid(Text_PrettyPrint_Leijen.docSemigroup)))(v.value0);
    };
    if (v instanceof Options_Applicative_Types.AltNode) {
        var alt_node = function (v1) {
            if (v1.length === 1) {
                return v1[0];
            };
            return Data_Functor.map(Options_Applicative_Help_Chunk.chunkFunctor)(Text_PrettyPrint_Leijen.parens)(Data_Array.foldr(Options_Applicative_Help_Chunk.chunked(function (x) {
                return function (y) {
                    return Text_PrettyPrint_Leijen.appendWithSoftline(x)(Text_PrettyPrint_Leijen.appendWithSoftline(Text_PrettyPrint_Leijen["char"]("|"))(y));
                };
            }))(Data_Monoid.mempty(Options_Applicative_Help_Chunk.chunkMonoid(Text_PrettyPrint_Leijen.docSemigroup)))(v1));
        };
        return alt_node(Data_Array.filter((function () {
            var $35 = Data_HeytingAlgebra.not(Data_HeytingAlgebra.heytingAlgebraBoolean);
            return function ($36) {
                return $35(Options_Applicative_Help_Chunk.isEmpty($36));
            };
        })())(Data_Functor.map(Data_Functor.functorArray)(fold_tree)(v.value0)));
    };
    throw new Error("Failed pattern match at Options.Applicative.Help.Core (line 116, column 1 - line 116, column 46): " + [ v.constructor.name ]);
};
var errorHelp = function (chunk) {
    return Data_Newtype.over()()(Options_Applicative_Help_Types.ParserHelp)(function (v) {
        return {
            helpError: chunk,
            helpBody: v.helpBody,
            helpFooter: v.helpFooter,
            helpHeader: v.helpHeader,
            helpSuggestions: v.helpSuggestions,
            helpUsage: v.helpUsage
        };
    })(Data_Monoid.mempty(Options_Applicative_Help_Types.parserHelpMonoid));
};
var cmdDesc = (function () {
    var desc = function (v) {
        return function (opt) {
            var v1 = (Data_Newtype.un()(Options_Applicative_Types.Option)(opt)).optMain;
            if (v1 instanceof Options_Applicative_Types.CmdReader) {
                return Data_Tuple.Tuple.create(v1.value0)(Options_Applicative_Help_Chunk.tabulate(Control_Bind.bind(Control_Bind.bindArray)(Data_Array.reverse(v1.value1))(function (cmd) {
                    return Control_Bind.bind(Control_Bind.bindArray)(Data_Maybe.maybe([  ])(Control_Applicative.pure(Control_Applicative.applicativeArray))(Data_Functor.map(Data_Maybe.functorMaybe)((function () {
                        var $37 = Data_Newtype.un()(Options_Applicative_Types.ParserInfo);
                        return function ($38) {
                            return (function (v2) {
                                return v2.infoProgDesc;
                            })($37($38));
                        };
                    })())(v1.value2(cmd))))(function (d) {
                        return Control_Applicative.pure(Control_Applicative.applicativeArray)(new Data_Tuple.Tuple(Text_PrettyPrint_Leijen.string(cmd), Text_PrettyPrint_Leijen.align(Options_Applicative_Help_Chunk.extractChunk(Text_PrettyPrint_Leijen.docMonoid)(d))));
                    });
                })));
            };
            return Data_Monoid.mempty(Data_Tuple.monoidTuple(Data_Maybe.monoidMaybe(Data_Semigroup.semigroupString))(Options_Applicative_Help_Chunk.chunkMonoid(Text_PrettyPrint_Leijen.docSemigroup)));
        };
    };
    return Options_Applicative_Common.mapParser(desc);
})();
var briefDesc$prime = function (showOptional) {
    return function (pprefs) {
        var style = {
            descSep: Text_PrettyPrint_Leijen.string("|"),
            descHidden: false,
            descOptional: showOptional,
            descSurround: true
        };
        var $39 = Options_Applicative_Common.treeMapParser(optDesc(pprefs)(style));
        return function ($40) {
            return fold_tree($39($40));
        };
    };
};
var missingDesc = briefDesc$prime(false);
var briefDesc = briefDesc$prime(true);
var parserUsage = function (pprefs) {
    return function (p) {
        return function (progn) {
            return Text_PrettyPrint_Leijen.hsep([ Text_PrettyPrint_Leijen.string("Usage:"), Text_PrettyPrint_Leijen.string(progn), Text_PrettyPrint_Leijen.align(Options_Applicative_Help_Chunk.extractChunk(Text_PrettyPrint_Leijen.docMonoid)(briefDesc(pprefs)(p))) ]);
        };
    };
};
var bodyHelp = function (chunk) {
    return Data_Newtype.over()()(Options_Applicative_Help_Types.ParserHelp)(function (v) {
        return {
            helpBody: chunk,
            helpError: v.helpError,
            helpFooter: v.helpFooter,
            helpHeader: v.helpHeader,
            helpSuggestions: v.helpSuggestions,
            helpUsage: v.helpUsage
        };
    })(Data_Monoid.mempty(Options_Applicative_Help_Types.parserHelpMonoid));
};
var parserHelp = function (pprefs) {
    return function (p) {
        var with_title = function (title) {
            return Data_Functor.map(Options_Applicative_Help_Chunk.chunkFunctor)(function (v) {
                return Text_PrettyPrint_Leijen.appendWithLine(Text_PrettyPrint_Leijen.string(title))(v);
            });
        };
        var group_title = function (arr) {
            var v = Data_Array_NonEmpty.uncons(arr);
            return with_title(Data_Maybe.fromMaybe("Available commands:")(Data_Tuple.fst(v.head)))(Options_Applicative_Help_Chunk.vcatChunks(Data_Semigroup.append(Data_Semigroup.semigroupArray)([ Data_Tuple.snd(v.head) ])(Data_Functor.map(Data_Functor.functorArray)(Data_Tuple.snd)(v.tail))));
        };
        var cs = Data_Array.groupBy(Data_Function.on(Data_Eq.eq(Data_Maybe.eqMaybe(Data_Eq.eqString)))(Data_Tuple.fst))(cmdDesc(p));
        return bodyHelp(Options_Applicative_Help_Chunk.vsepChunks(Data_Semigroup.append(Data_Semigroup.semigroupArray)([ with_title("Available options:")(fullDesc(pprefs)(p)) ])(Data_Functor.map(Data_Functor.functorArray)(group_title)(cs))));
    };
};
module.exports = {
    cmdDesc: cmdDesc,
    briefDesc: briefDesc,
    missingDesc: missingDesc,
    fold_tree: fold_tree,
    fullDesc: fullDesc,
    errorHelp: errorHelp,
    headerHelp: headerHelp,
    suggestionsHelp: suggestionsHelp,
    usageHelp: usageHelp,
    bodyHelp: bodyHelp,
    footerHelp: footerHelp,
    parserHelp: parserHelp,
    parserUsage: parserUsage,
    ParserHelp: Options_Applicative_Types.ParserHelp
};
